#!/bin/bash

set -e

image="harmony/gdal"
tag=${1:-latest}

region=${ECR_REGION-"us-east-1"}

account=$(aws sts get-caller-identity --output text --query 'Account')

$(aws ecr get-login --no-include-email --region ${region})
docker tag ${image}:${tag} ${account}.dkr.ecr.${region}.amazonaws.com/${image}:${tag}
docker push ${account}.dkr.ecr.${region}.amazonaws.com/${image}:${tag}
